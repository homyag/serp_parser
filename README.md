# SERP Parser - Анализатор поисковой выдачи Яндекса

Этот скрипт предназначен для автоматизации поиска заданного домена в выдаче Яндекса, перехода на найденный сайт, глубокого взаимодействия с элементами сайта, поиска и копирования номера телефона.

## Функциональность

- Поиск заданного домена в выдаче Яндекса по указанному запросу
- Определение позиции сайта в результатах поиска
- Автоматическое решение капчи (с возможностью ручного решения при необходимости)
- Переход на найденный сайт и имитация поведения пользователя
- **Активное взаимодействие с элементами сайта:**
  - Навигация по разделам сайта
  - Нажатие на кнопки и интерактивные элементы
  - Заполнение форм случайными данными
  - Переключение между вкладками и элементами аккордеона
- Расширенный поиск, выделение и копирование телефонного номера на сайте
- Сохранение найденных телефонов в файл
- Создание скриншотов страниц

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/serp_parser.git
cd serp_parser
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv .venv
source .venv/bin/activate  # На Windows: .venv\Scripts\activate
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Структура проекта

```
serp_parser/
├── main.py                # Точка входа в программу
├── config.py              # Конфигурация приложения
├── user_interface.py      # Взаимодействие с пользователем
├── browser_utils.py       # Функции для работы с браузером
├── captcha_solver.py      # Решение капчи
├── search.py              # Функции поиска
├── content_extractor.py   # Извлечение данных со страниц
└── site_interaction.py    # Взаимодействие с элементами сайта
```

## Использование

### Запуск с интерактивным вводом параметров:

```bash
python main.py
```

### Запуск с параметрами командной строки:

```bash
python main.py --query "поисковый запрос" --domain "example.com" --pages 3 --interaction "high"
```

### Доступные параметры:

| Параметр       | Описание                                      | Значение по умолчанию |
|----------------|-----------------------------------------------|-----------------------|
| `--query`      | Поисковый запрос                              | (требуется ввод)     |
| `--domain`     | Домен для поиска                              | (требуется ввод)     |
| `--pages`      | Количество страниц результатов для проверки   | 3                     |
| `--headless`   | Запустить браузер в фоновом режиме            | False (видимый режим) |
| `--delay`      | Множитель задержки между действиями           | 1.0                   |
| `--stay-time`  | Минимальное время пребывания на сайте (сек.)  | 15                    |
| `--interaction`| Уровень взаимодействия с сайтом               | medium                |

## Уровни взаимодействия с сайтом

Скрипт поддерживает три уровня взаимодействия с найденным сайтом:

1. **low** (низкий) - минимальное взаимодействие:
   - Скромное время пребывания на сайте (около 30 секунд)
   - Меньшее количество кликов и переходов
   - Без заполнения форм

2. **medium** (средний) - умеренное взаимодействие:
   - Активное время пребывания на сайте (около 90 секунд)
   - Несколько переходов на другие страницы
   - Выборочное заполнение форм
   - Взаимодействие с табами и аккордеонами

3. **high** (высокий) - глубокое взаимодействие:
   - Продолжительное время на сайте (до 180 секунд)
   - Множественные переходы по страницам
   - Активное заполнение форм
   - Полноценное исследование структуры сайта

## Особенности работы с капчей

При обнаружении капчи скрипт:
1. Пытается решить ее автоматически разными способами
2. Если автоматическое решение не удалось, предлагает пользователю решить капчу вручную
3. После решения капчи продолжает выполнение задачи

## Расширенный поиск телефонных номеров

Скрипт использует несколько методов для поиска телефонных номеров:
1. Анализ текстового содержимого страницы
2. Поиск ссылок с префиксом `tel:`
3. Поиск элементов с классами или ID, связанными с телефонами
4. Проверка скрытых элементов и атрибутов
5. Сканирование HTML-кода на наличие телефонных номеров
6. Проверка контактных блоков в шапке и подвале сайта

## Принципы проектирования

- **SOLID** - каждый модуль имеет единую ответственность
- **DRY** (Don't Repeat Yourself) - устранение повторяющегося кода
- **KISS** (Keep It Simple, Stupid) - простота и понятность кода

## Требования

- Python 3.6+
- Selenium
- requests
- BeautifulSoup4
- webdriver-manager
- Доступ к Chrome или ChromeDriver

## Примечания

- Скрипт сохраняет найденные номера телефонов в файл `phone_numbers.txt` в корневой директории проекта.
- Скриншоты сохраняются с префиксом `screenshot_` и меткой времени.
- При запуске браузера в видимом режиме вы можете наблюдать все действия скрипта в реальном времени.
- Высокий уровень взаимодействия с сайтом может привести к отправке заполненных форм (отключено по умолчанию).